<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>opsBuddy - AI-Driven OnCall Support</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Pattern overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 1px, transparent 1px),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none;
            z-index: -1;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
            font-size: 1.2rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .app {
            opacity: 0;
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        @keyframes slideInFromTop {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading">
            <div class="spinner"></div>
            <span>Loading opsBuddy...</span>
        </div>
    </div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/socket.io-client@4/dist/socket.io.js"></script>

    <script type="text/babel">
        'use strict';

        // Main App Component will be loaded here
        const { useState, useEffect } = React;

        // Socket connection
        const socket = io();

        // Main App Component
        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            const [services, setServices] = useState([]);
            const [metrics, setMetrics] = useState({});
            const [logs, setLogs] = useState([]);
            const [incidents, setIncidents] = useState({});
            const [realtimeErrors, setRealtimeErrors] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                // Load initial data
                loadServices();
                loadMetrics();
                loadIncidents();

                // Socket event listeners
                socket.on('connect', () => {
                    console.log('Connected to server');
                    setLoading(false);
                });

                socket.on('update', (data) => {
                    if (data.services) setServices(data.services);
                    if (data.metrics) setMetrics(data.metrics);
                });

                socket.on('service_health_update', (data) => {
                    console.log('Service health update received:', data);
                    if (data.data && data.data.service && data.data.status) {
                        // Update services state with new health data
                        setServices(prevServices => {
                            if (!prevServices || prevServices.length === 0) {
                                console.warn('No services in state to update');
                                return prevServices;
                            }

                            return prevServices.map(service => {
                                // Match service names properly
                                const serviceKey = data.data.service;
                                const serviceNameMatch = service.name.toLowerCase().replace(' service', '').replace(/\s+/g, '-');

                                if (serviceKey === 'api-gateway' && serviceNameMatch === 'api-gateway' ||
                                    serviceKey === 'file-service' && serviceNameMatch === 'file-service' ||
                                    serviceKey === 'utility-service' && serviceNameMatch === 'utility-service' ||
                                    serviceKey === 'analytics-service' && serviceNameMatch === 'analytics-service' ||
                                    serviceKey === 'incident-service' && serviceNameMatch === 'incident-service' ||
                                    serviceKey === 'monitor-service' && serviceNameMatch === 'monitor-service' ||
                                    serviceKey === 'ui-service' && serviceNameMatch === 'ui-service') {

                                    console.log(`Updating ${service.name} status to ${data.data.status.health}`);
                                    return {
                                        ...service,
                                        status: data.data.status.health,
                                        response_time: Math.round(data.data.status.response_time * 1000),
                                        details: data.data.status
                                    };
                                }
                                return service;
                            });
                        });
                    } else {
                        console.warn('Invalid service health update data:', data);
                    }
                });

                socket.on('incident_update', (data) => {
                    console.log('Incident update received:', data);
                    if (data.data) {
                        // Update incidents state with new data
                        setIncidents(prevIncidents => ({
                            ...prevIncidents,
                            recent_errors: [data.data, ...(prevIncidents.recent_errors || []).slice(0, 9)]
                        }));
                    }
                });

                socket.on('error_log', (data) => {
                    console.log('Error log received:', data);
                    if (data.error) {
                        // Add new error to realtime errors list
                        setRealtimeErrors(prevErrors => {
                            const newErrors = [data.error, ...prevErrors.slice(0, 49)]; // Keep last 50 errors
                            return newErrors;
                        });
                    }
                });

                socket.on('error', (error) => {
                    console.error('Socket error:', error);
                });

                // Request periodic updates
                const interval = setInterval(() => {
                    socket.emit('request_update', { timestamp: new Date().toISOString() });
                }, 5000);

                return () => {
                    clearInterval(interval);
                    socket.off('connect');
                    socket.off('update');
                    socket.off('service_health_update');
                    socket.off('incident_update');
                    socket.off('error_log');
                    socket.off('error');
                };
            }, []);

            const loadServices = async () => {
                try {
                    const response = await fetch('/api/monitor/services');
                    const data = await response.json();
                    if (data.services) {
                        // Transform monitor service data to UI format
                        const transformedServices = Object.entries(data.services).map(([name, service]) => {
                            let displayName = '';
                            let description = '';

                            switch(name) {
                                case 'api-gateway':
                                    displayName = 'API Gateway';
                                    description = 'Main API Gateway service';
                                    break;
                                case 'file-service':
                                    displayName = 'File Service';
                                    description = 'File management and storage service';
                                    break;
                                case 'utility-service':
                                    displayName = 'Utility Service';
                                    description = 'System utility and command execution service';
                                    break;
                                case 'analytics-service':
                                    displayName = 'Analytics Service';
                                    description = 'Log analytics and metrics collection service';
                                    break;
                                case 'incident-service':
                                    displayName = 'Incident Service';
                                    description = 'Real-time error monitoring and Redis pub/sub';
                                    break;
                                case 'monitor-service':
                                    displayName = 'Monitor Service';
                                    description = 'Real-time health monitoring and WebSocket updates';
                                    break;
                                case 'ui-service':
                                    displayName = 'UI Service';
                                    description = 'Web interface and dashboard service';
                                    break;
                                default:
                                    displayName = name.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
                                    description = `${name.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())} service for opsBuddy platform`;
                            }

                            return {
                                name: displayName,
                                port: getServicePort(name),
                                status: service.status,
                                response_time: Math.round(service.response_time * 1000), // Convert to ms
                                uptime: service.last_check ? 100 : 0, // Simplified uptime calculation
                                description: description,
                                details: service
                            };
                        });
                        setServices(transformedServices);
                    }
                } catch (error) {
                    console.error('Error loading services:', error);
                    // Fallback to old endpoint if monitor service is not available
                    try {
                        const response = await fetch('/api/services');
                        const data = await response.json();
                        setServices(data);
                    } catch (fallbackError) {
                        console.error('Error loading fallback services:', fallbackError);
                    }
                }
            };

            const getServicePort = (serviceName) => {
                const portMap = {
                    'api-gateway': 8000,
                    'file-service': 8001,
                    'utility-service': 8002,
                    'analytics-service': 8003,
                    'incident-service': 8004,
                    'monitor-service': 8005,
                    'ui-service': 3000
                };
                return portMap[serviceName] || 8000;
            };

            const loadMetrics = async () => {
                try {
                    const response = await fetch('/api/analytics/metrics');
                    const data = await response.json();
                    setMetrics(data);
                } catch (error) {
                    console.error('Error loading metrics:', error);
                }
            };

            const loadIncidents = async () => {
                try {
                    const response = await fetch('/api/incidents');
                    const data = await response.json();
                    setIncidents(data);
                } catch (error) {
                    console.error('Error loading incidents:', error);
                }
            };

            if (loading) {
                return React.createElement('div', { className: 'loading' },
                    React.createElement('div', { className: 'spinner' }),
                    React.createElement('span', null, 'Loading opsBuddy...')
                );
            }

            return React.createElement('div', { className: 'app' },
                React.createElement(Navbar, { activeTab: activeTab, setActiveTab: setActiveTab }),
                React.createElement('main', null,
                    activeTab === 'home' && React.createElement(HomePage),
                    activeTab === 'health' && React.createElement(ServiceHealth, { services: services }),
                    activeTab === 'analytics' && React.createElement(Analytics, { metrics: metrics, logs: logs, incidents: incidents, loadIncidents: loadIncidents, realtimeErrors: realtimeErrors })
                )
            );
        };

        // Navbar Component
        const Navbar = ({ activeTab, setActiveTab }) => {
            const tabs = [
                { id: 'home', icon: 'fas fa-home', label: 'Home' },
                { id: 'health', icon: 'fas fa-heartbeat', label: 'Service Health' },
                { id: 'analytics', icon: 'fas fa-chart-bar', label: 'Analytics' }
            ];

            return React.createElement('nav', {
                style: {
                    background: 'rgba(255, 255, 255, 0.1)',
                    backdropFilter: 'blur(10px)',
                    borderBottom: '1px solid rgba(255, 255, 255, 0.2)',
                    padding: '1rem 2rem',
                    position: 'sticky',
                    top: 0,
                    zIndex: 100
                }
            }, React.createElement('div', {
                style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    maxWidth: '1200px',
                    margin: '0 auto'
                }
            }, React.createElement('div', {
                style: {
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem',
                    color: 'white',
                    fontSize: '1.5rem',
                    fontWeight: 'bold'
                }
            }, React.createElement('i', { className: 'fas fa-heartbeat' }), 'opsBuddy'), React.createElement('div', {
                style: {
                    display: 'flex',
                    gap: '2rem',
                    alignItems: 'center'
                }
            }, tabs.map(tab => React.createElement('button', {
                key: tab.id,
                onClick: () => setActiveTab(tab.id),
                style: {
                    background: activeTab === tab.id ? 'rgba(255, 255, 255, 0.2)' : 'transparent',
                    border: 'none',
                    padding: '0.75rem 1.5rem',
                    borderRadius: '25px',
                    color: 'white',
                    cursor: 'pointer',
                    fontSize: '1rem',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem',
                    transition: 'all 0.3s ease',
                    backdropFilter: 'blur(10px)'
                }
            }, React.createElement('i', { className: tab.icon }), tab.label)))));
        };

        // Home Page Component
        const HomePage = () => {
            const features = [
                {
                    icon: 'ðŸ¤–',
                    title: 'AI-Powered Intelligence',
                    description: 'Advanced machine learning algorithms analyze system patterns and predict issues before they occur.'
                },
                {
                    icon: 'â°',
                    title: '24/7 Monitoring',
                    description: 'Continuous monitoring of all your services with real-time alerts and automated responses.'
                },
                {
                    icon: 'ðŸ“Š',
                    title: 'Real-time Analytics',
                    description: 'Comprehensive analytics and insights to optimize your infrastructure performance.'
                }
            ];

            return React.createElement('div', null,
                React.createElement('section', {
                    style: {
                        padding: '6rem 2rem 4rem',
                        textAlign: 'center',
                        color: 'white',
                        position: 'relative'
                    }
                }, React.createElement('div', {
                    style: {
                        maxWidth: '800px',
                        margin: '0 auto',
                        position: 'relative',
                        zIndex: 2
                    }
                }, React.createElement('h1', {
                    style: {
                        fontSize: '4rem',
                        fontWeight: 'bold',
                        marginBottom: '1rem',
                        background: 'linear-gradient(135deg, #fff, #a8edea)',
                        WebkitBackgroundClip: 'text',
                        WebkitTextFillColor: 'transparent',
                        backgroundClip: 'text'
                    }
                }, 'ðŸ  opsBuddy'), React.createElement('p', {
                    style: {
                        fontSize: '1.5rem',
                        marginBottom: '3rem',
                        opacity: 0.9,
                        lineHeight: 1.6
                    }
                }, 'AI-driven oncall support platform for modern DevOps teams'))),
                React.createElement('section', {
                    style: {
                        padding: '2rem',
                        maxWidth: '1200px',
                        margin: '0 auto'
                    }
                }, React.createElement('div', {
                    style: {
                        display: 'grid',
                        gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
                        gap: '2rem',
                        marginTop: '2rem'
                    }
                }, features.map((feature, index) => React.createElement('div', {
                    key: index,
                    style: {
                        background: 'rgba(255, 255, 255, 0.1)',
                        backdropFilter: 'blur(10px)',
                        border: '1px solid rgba(255, 255, 255, 0.2)',
                        borderRadius: '20px',
                        padding: '2rem',
                        textAlign: 'center',
                        color: 'white',
                        transition: 'all 0.3s ease',
                        cursor: 'pointer'
                    }
                }, React.createElement('div', {
                    style: {
                        fontSize: '3rem',
                        marginBottom: '1rem'
                    }
                }, feature.icon), React.createElement('h3', {
                    style: {
                        fontSize: '1.5rem',
                        marginBottom: '1rem',
                        color: '#a8edea'
                    }
                }, feature.title), React.createElement('p', {
                    style: {
                        opacity: 0.8,
                        lineHeight: 1.6
                    }
                }, feature.description)))))
            );
        };

        // Service Health Component
        const ServiceHealth = ({ services }) => {
            // Default services data when API is not available
            const defaultServices = [
                {
                    name: 'API Gateway',
                    port: 8000,
                    status: 'unknown',
                    response_time: 0,
                    uptime: 0,
                    description: 'Main API Gateway service'
                },
                {
                    name: 'File Service',
                    port: 8001,
                    status: 'unknown',
                    response_time: 0,
                    uptime: 0,
                    description: 'File management and storage service'
                },
                {
                    name: 'Utility Service',
                    port: 8002,
                    status: 'unknown',
                    response_time: 0,
                    uptime: 0,
                    description: 'System utility and command execution service'
                },
                {
                    name: 'Analytics Service',
                    port: 8003,
                    status: 'unknown',
                    response_time: 0,
                    uptime: 0,
                    description: 'Log analytics and metrics collection service'
                },
                {
                    name: 'Incident Service',
                    port: 8004,
                    status: 'unknown',
                    response_time: 0,
                    uptime: 0,
                    description: 'Real-time error monitoring and Redis pub/sub'
                },
                {
                    name: 'Monitor Service',
                    port: 8005,
                    status: 'unknown',
                    response_time: 0,
                    uptime: 0,
                    description: 'Real-time health monitoring and WebSocket updates'
                },
                {
                    name: 'UI Service',
                    port: 3000,
                    status: 'unknown',
                    response_time: 0,
                    uptime: 0,
                    description: 'Web interface and dashboard service'
                }
            ];

            // Use API data if available, otherwise show loading
            const displayServices = services && services.length > 0 ? services : [];

            // Show loading if no services data available
            if (displayServices.length === 0) {
                return React.createElement('div', {
                    style: {
                        padding: '2rem',
                        maxWidth: '1400px',
                        margin: '0 auto',
                        textAlign: 'center',
                        color: 'white'
                    }
                }, React.createElement('h2', {
                    style: {
                        color: 'white',
                        fontSize: '2.5rem',
                        marginBottom: '2rem'
                    }
                }, 'ðŸ«€ Service Health Dashboard'), React.createElement('div', {
                    style: {
                        background: 'rgba(255, 255, 255, 0.1)',
                        backdropFilter: 'blur(10px)',
                        border: '1px solid rgba(255, 255, 255, 0.2)',
                        borderRadius: '20px',
                        padding: '3rem',
                        color: 'white'
                    }
                }, React.createElement('div', {
                    style: {
                        fontSize: '4rem',
                        marginBottom: '1rem',
                        animation: 'spin 2s linear infinite'
                    }
                }, 'ðŸ”„'), React.createElement('h3', {
                    style: {
                        fontSize: '1.5rem',
                        marginBottom: '1rem',
                        color: '#a8edea'
                    }
                }, 'Loading Service Health Data...'), React.createElement('p', {
                    style: {
                        opacity: 0.8,
                        fontSize: '1rem'
                    }
                }, 'Fetching real-time service status from monitoring system')));
            }

            const getStatusColor = (status) => {
                switch (status) {
                    case 'healthy': return '#4CAF50';
                    case 'warning': return '#FF9800';
                    case 'error': return '#f44336';
                    case 'unknown': return '#9E9E9E';
                    default: return '#9E9E9E';
                }
            };

            const getStatusIcon = (status) => {
                switch (status) {
                    case 'healthy': return 'fas fa-check-circle';
                    case 'warning': return 'fas fa-exclamation-triangle';
                    case 'error': return 'fas fa-times-circle';
                    case 'unknown': return 'fas fa-question-circle';
                    default: return 'fas fa-question-circle';
                }
            };

            return React.createElement('div', {
                style: {
                    padding: '2rem',
                    maxWidth: '1400px',
                    margin: '0 auto'
                }
            }, React.createElement('h2', {
                style: {
                    color: 'white',
                    fontSize: '2.5rem',
                    marginBottom: '2rem',
                    textAlign: 'center'
                }
            }, 'ðŸ«€ Service Health Dashboard'), React.createElement('div', {
                style: {
                    display: 'grid',
                    gridTemplateColumns: 'repeat(auto-fit, minmax(350px, 1fr))',
                    gap: '2rem'
                }
            }, displayServices.map((service, index) => React.createElement('div', {
                key: index,
                style: {
                    background: 'rgba(255, 255, 255, 0.1)',
                    backdropFilter: 'blur(10px)',
                    border: `1px solid rgba(255, 255, 255, 0.2)`,
                    borderRadius: '20px',
                    padding: '2rem',
                    color: 'white',
                    transition: 'all 0.3s ease',
                    cursor: 'pointer',
                    position: 'relative',
                    overflow: 'hidden'
                }
            }, React.createElement('div', {
                style: {
                    position: 'absolute',
                    top: 0,
                    left: 0,
                    right: 0,
                    height: '4px',
                    background: getStatusColor(service.status)
                }
            }), React.createElement('div', {
                style: {
                    display: 'flex',
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    marginBottom: '1.5rem'
                }
            }, React.createElement('div', {
                style: {
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.75rem'
                }
            }, React.createElement('i', {
                className: getStatusIcon(service.status),
                style: {
                    fontSize: '1.5rem',
                    color: getStatusColor(service.status)
                }
            }), React.createElement('h3', {
                style: {
                    fontSize: '1.4rem',
                    color: '#a8edea',
                    margin: 0
                }
            }, service.name)), React.createElement('div', {
                style: {
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem'
                }
            }, React.createElement('span', {
                style: {
                    padding: '0.25rem 0.75rem',
                    borderRadius: '15px',
                    fontSize: '0.8rem',
                    background: getStatusColor(service.status),
                    color: 'white',
                    fontWeight: 'bold'
                }
            }, service.status.toUpperCase()), React.createElement('span', {
                style: {
                    fontSize: '0.9rem',
                    opacity: 0.7
                }
            }, `Port ${service.port}`))), React.createElement('p', {
                style: {
                    fontSize: '0.9rem',
                    opacity: 0.8,
                    marginBottom: '1.5rem',
                    lineHeight: 1.4
                }
            }, service.description), React.createElement('div', {
                style: {
                    display: 'grid',
                    gridTemplateColumns: '1fr 1fr',
                    gap: '1rem',
                    marginBottom: '1.5rem'
                }
            }, React.createElement('div', {
                style: {
                    background: 'rgba(255, 255, 255, 0.05)',
                    padding: '1rem',
                    borderRadius: '10px',
                    textAlign: 'center'
                }
            }, React.createElement('div', {
                style: {
                    fontSize: '0.8rem',
                    opacity: 0.7,
                    marginBottom: '0.5rem',
                    textTransform: 'uppercase',
                    letterSpacing: '0.5px'
                }
            }, 'Response Time'), React.createElement('div', {
                style: {
                    fontSize: '1.8rem',
                    fontWeight: 'bold',
                    color: service.response_time > 0 ? '#4CAF50' : '#9E9E9E'
                }
            }, service.response_time > 0 ? `${service.response_time}ms` : '--')), React.createElement('div', {
                style: {
                    background: 'rgba(255, 255, 255, 0.05)',
                    padding: '1rem',
                    borderRadius: '10px',
                    textAlign: 'center'
                }
            }, React.createElement('div', {
                style: {
                    fontSize: '0.8rem',
                    opacity: 0.7,
                    marginBottom: '0.5rem',
                    textTransform: 'uppercase',
                    letterSpacing: '0.5px'
                }
            }, 'Uptime'), React.createElement('div', {
                style: {
                    fontSize: '1.8rem',
                    fontWeight: 'bold',
                    color: service.uptime > 0 ? '#2196F3' : '#9E9E9E'
                }
            }, service.uptime > 0 ? `${service.uptime}%` : '--'))), React.createElement('button', {
                style: {
                    width: '100%',
                    padding: '0.75rem',
                    background: 'rgba(255, 255, 255, 0.2)',
                    border: '1px solid rgba(255, 255, 255, 0.3)',
                    borderRadius: '10px',
                    color: 'white',
                    cursor: 'pointer',
                    fontSize: '1rem',
                    transition: 'all 0.3s ease',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    gap: '0.5rem'
                }
            }, React.createElement('i', { className: 'fas fa-sync-alt' }), 'Check Health')))));
        };

        // Analytics Component - Focused on Real-time Error Logs
        const Analytics = ({ metrics, logs, incidents, loadIncidents, realtimeErrors }) => {
            // Combine realtimeErrors and incidents data
            const allErrors = [
                ...realtimeErrors,
                ...(incidents.incidents && incidents.incidents.recent_errors ? 
                    incidents.incidents.recent_errors.map(error => ({
                        ...error,
                        timestamp: error.timestamp,
                        service: error.service,
                        level: error.level,
                        message: error.message || 'No message available',
                        logger: error.logger || 'unknown'
                    })) : [])
            ];

            const getServiceIcon = (service) => {
                const icons = {
                    'api-gateway': 'fas fa-route',
                    'file-service': 'fas fa-file-alt',
                    'utility-service': 'fas fa-tools',
                    'analytics-service': 'fas fa-chart-line',
                    'incident-service': 'fas fa-exclamation-circle',
                    'monitor-service': 'fas fa-heartbeat',
                    'ui-service': 'fas fa-desktop'
                };
                return icons[service] || 'fas fa-server';
            };

            const getServiceColor = (service) => {
                const colors = {
                    'api-gateway': '#2196F3',
                    'file-service': '#4CAF50',
                    'utility-service': '#FF9800',
                    'analytics-service': '#9C27B0',
                    'incident-service': '#F44336',
                    'monitor-service': '#00BCD4',
                    'ui-service': '#607D8B'
                };
                return colors[service] || '#FFFFFF';
            };

            const getLevelIcon = (level) => {
                switch (level?.toUpperCase()) {
                    case 'CRITICAL': return 'fas fa-skull-crossbones';
                    case 'ERROR': return 'fas fa-times-circle';
                    case 'WARNING': return 'fas fa-exclamation-triangle';
                    case 'INFO': return 'fas fa-info-circle';
                    default: return 'fas fa-question-circle';
                }
            };

            const getLevelColor = (level) => {
                switch (level?.toUpperCase()) {
                    case 'CRITICAL': return '#FF1744';
                    case 'ERROR': return '#F44336';
                    case 'WARNING': return '#FF9800';
                    case 'INFO': return '#2196F3';
                    default: return '#9E9E9E';
                }
            };

            return React.createElement('div', {
                style: {
                    padding: '2rem',
                    maxWidth: '1400px',
                    margin: '0 auto'
                }
            },
            React.createElement('h2', {
                style: {
                    color: 'white',
                    fontSize: '2.5rem',
                    marginBottom: '2rem',
                    textAlign: 'center',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    gap: '1rem'
                }
            }, React.createElement('i', { className: 'fas fa-exclamation-triangle' }), 'Recent Incidents & Errors'),

            // Real-time Error Logs Section
            React.createElement('div', {
                style: {
                    background: 'rgba(255, 255, 255, 0.1)',
                    backdropFilter: 'blur(10px)',
                    border: '1px solid rgba(255, 255, 255, 0.2)',
                    borderRadius: '20px',
                    padding: '2rem',
                    marginBottom: '2rem'
                }
            },
            React.createElement('div', {
                style: {
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem',
                    marginBottom: '1.5rem',
                    paddingBottom: '1rem',
                    borderBottom: '1px solid rgba(255, 255, 255, 0.2)'
                }
            },
            React.createElement('i', {
                className: 'fas fa-bolt',
                style: { color: '#4CAF50', fontSize: '1.2rem' }
            }),
            React.createElement('h3', {
                style: {
                    color: 'white',
                    fontSize: '1.5rem',
                    margin: 0
                }
            }, 'Real-time Error Stream'),
            React.createElement('div', {
                style: {
                    color: '#4CAF50',
                    fontSize: '0.9rem',
                    marginLeft: 'auto',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.5rem'
                }
            },
            React.createElement('div', {
                style: {
                    width: '8px',
                    height: '8px',
                    backgroundColor: '#4CAF50',
                    borderRadius: '50%',
                    animation: 'pulse 2s infinite'
                }
            }),
            'Live'
            )
            ),

            // Real-time errors display - use combined error data
            allErrors.length > 0 ?
            React.createElement('div', {
                style: {
                    maxHeight: '600px',
                    overflowY: 'auto',
                    display: 'flex',
                    flexDirection: 'column',
                    gap: '1rem'
                }
            },
            allErrors.map((error, index) =>
                React.createElement('div', {
                    key: index,
                    style: {
                        background: 'rgba(0, 0, 0, 0.2)',
                        border: `1px solid ${getLevelColor(error.level)}`,
                        borderRadius: '15px',
                        padding: '1.5rem',
                        transition: 'all 0.3s ease',
                        animation: 'slideInFromTop 0.5s ease-out'
                    }
                },
                React.createElement('div', {
                    style: {
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center',
                        marginBottom: '1rem'
                    }
                },
                React.createElement('div', {
                    style: {
                        display: 'flex',
                        alignItems: 'center',
                        gap: '0.75rem'
                    }
                },
                React.createElement('i', {
                    className: getServiceIcon(error.service),
                    style: {
                        color: getServiceColor(error.service),
                        fontSize: '1.2rem'
                    }
                }),
                React.createElement('span', {
                    style: {
                        color: getServiceColor(error.service),
                        fontWeight: 'bold',
                        fontSize: '1.1rem'
                    }
                }, error.service?.replace('-', ' ').toUpperCase() || 'UNKNOWN'),
                React.createElement('span', {
                    style: {
                        background: getLevelColor(error.level),
                        padding: '0.25rem 0.75rem',
                        borderRadius: '12px',
                        fontSize: '0.8rem',
                        color: 'white',
                        fontWeight: 'bold',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '0.25rem'
                    }
                },
                React.createElement('i', { className: getLevelIcon(error.level) }),
                error.level || 'ERROR'
                )
                ),
                React.createElement('div', {
                    style: {
                        color: '#a8edea',
                        fontSize: '0.9rem',
                        opacity: 0.8
                    }
                }, new Date(error.timestamp || Date.now()).toLocaleString())
                ),

                React.createElement('div', {
                    style: {
                        marginTop: '1rem',
                        padding: '1rem',
                        background: 'rgba(255, 255, 255, 0.05)',
                        borderRadius: '10px',
                        borderLeft: `4px solid ${getLevelColor(error.level)}`
                    }
                },
                React.createElement('div', {
                    style: {
                        color: 'white',
                        fontFamily: 'monospace',
                        fontSize: '0.9rem',
                        marginBottom: '0.5rem',
                        wordBreak: 'break-word'
                    }
                }, React.createElement('strong', { style: { color: '#a8edea' } }, 'Logger:'), ` ${error.logger || 'unknown'}`),
                React.createElement('div', {
                    style: {
                        color: 'white',
                        fontFamily: 'monospace',
                        fontSize: '0.9rem',
                        wordBreak: 'break-word',
                        lineHeight: '1.4'
                    }
                }, React.createElement('strong', { style: { color: '#a8edea' } }, 'Message:'), ` ${error.message || 'No message'}`)
                )
                )
                )
            ) :
            React.createElement('div', {
                style: {
                    textAlign: 'center',
                    padding: '3rem',
                    color: 'white',
                    opacity: 0.7
                }
            },
            React.createElement('i', {
                className: 'fas fa-check-circle',
                style: { fontSize: '3rem', marginBottom: '1rem', color: '#4CAF50' }
            }),
            React.createElement('h3', {
                style: { marginBottom: '0.5rem', color: '#4CAF50' }
            }, 'All Systems Operational'),
            React.createElement('p', null, 'No recent errors detected. Monitoring for new incidents...')
            )
            ),

            // Summary Statistics
            React.createElement('div', {
                style: {
                    display: 'grid',
                    gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                    gap: '1rem',
                    marginTop: '2rem'
                }
            },
            React.createElement('div', {
                style: {
                    background: 'rgba(76, 175, 80, 0.1)',
                    border: '1px solid rgba(76, 175, 80, 0.3)',
                    borderRadius: '15px',
                    padding: '1.5rem',
                    textAlign: 'center'
                }
            },
            React.createElement('div', {
                style: { fontSize: '2rem', fontWeight: 'bold', color: '#4CAF50', marginBottom: '0.5rem' }
            }, allErrors.length),
            React.createElement('div', {
                style: { color: 'white', opacity: 0.8, fontSize: '0.9rem' }
            }, 'Total Errors Displayed')
            ),

            React.createElement('div', {
                style: {
                    background: 'rgba(33, 150, 243, 0.1)',
                    border: '1px solid rgba(33, 150, 243, 0.3)',
                    borderRadius: '15px',
                    padding: '1.5rem',
                    textAlign: 'center'
                }
            },
            React.createElement('div', {
                style: { fontSize: '2rem', fontWeight: 'bold', color: '#2196F3', marginBottom: '0.5rem' }
            }, new Set(allErrors.map(e => e.service).filter(Boolean)).size),
            React.createElement('div', {
                style: { color: 'white', opacity: 0.8, fontSize: '0.9rem' }
            }, 'Services Reporting')
            ),

            React.createElement('div', {
                style: {
                    background: 'rgba(255, 152, 0, 0.1)',
                    border: '1px solid rgba(255, 152, 0, 0.3)',
                    borderRadius: '15px',
                    padding: '1.5rem',
                    textAlign: 'center'
                }
            },
            React.createElement('div', {
                style: { fontSize: '2rem', fontWeight: 'bold', color: '#FF9800', marginBottom: '0.5rem' }
            }, allErrors.filter(e => e.level === 'CRITICAL').length),
            React.createElement('div', {
                style: { color: 'white', opacity: 0.8, fontSize: '0.9rem' }
            }, 'Critical Errors')
            )
            ));
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>